#src = $(wildcard *.c)
#modules = $(wildcard modules/*.c)
#obj = $(wildcard target/*.o)

ARMFLAGS = -O1 -march=armv7-a -mtune=cortex-a8 -mfloat-abi=hard -mfpu=neon -ftree-vectorize -ffast-math -DNDEBUG 
LDFLAGS = -lm -L/root/Bela/lib -lbela
CFLAGS = -Wall -Iinclude -I/root/Bela/include

render: src/render.cpp protopatch.o
	clang++ -o target/render src/render.cpp target/sin.o target/delay.o target/adc.o target/dac.o target/protopatch.o $(CFLAGS) $(LDFLAGS) $(ARMFLAGS)

delay.o: nodes/delay.c protopatch.o
	cc -c nodes/delay.c -o target/delay.o $(CFLAGS) $(LDFLAGS)

adc.o: nodes/adc.c protopatch.o
	cc -c nodes/adc.c -o target/adc.o $(CFLAGS) $(LDFLAGS)

dac.o: nodes/dac.c protopatch.o
	cc -c nodes/dac.c -o target/dac.o $(CFLAGS) $(LDFLAGS)

sin.o: nodes/sin.c protopatch.o
	cc -c nodes/sin.c -o target/sin.o $(CFLAGS) $(LDFLAGS)

protopatch.o: src/protopatch.c
	cc -c src/protopatch.c -o target/protopatch.o $(CFLAGS) $(LDFLAGS)

.PHONY: clean

clean:
	rm target/*
